import{r as l,R as u,z as P,c as S,C as M,D as O,u as $,g as R,j as s,b as j}from"./index-XkiSkCIq.js";import"./lodash-ps-9DWTQ.js";import{I as z,e as B}from"./index-Cu020-X3.js";import"./iconBase-DXw1Gjh5.js";const V=()=>{const[E,L]=l.useState({}),[a,b]=l.useState({}),[y,w]=l.useState({}),[d,x]=l.useState(0),[n,N]=u(P);u(S);const[i,p]=u(M),[c,I]=u(O),m=$(),h=sessionStorage.getItem("userId"),g=R();l.useEffect(()=>{const e={userId:h};(async()=>{try{const t=await j.get("/api/user/orderId",{params:e,headers:{Authorization:`Bearer ${g}`}});console.log(t.data.resultData);const o=t.data.resultData;p({...i,orderId:o}),N(o)}catch(t){console.log(t)}})()},[n]),l.useEffect(()=>{const e={orderId:n};(async()=>{try{const t=await j.get("/api/order",{params:e,headers:{Authorization:`Bearer ${g}`}});console.log(t.data.resultData);const o=t.data.resultData.totalPrice;x(o)}catch(t){console.log(t)}})()},[]);const v=async()=>{const e={orderId:n,userId:i.userId||h,point:i.point};console.log(e);try{const r=await j.post("/api/user/user-payment-member",e,{headers:{Authorization:`Bearer ${g}`}});console.log(r.data.resultData),r.data.resultData>=0?(console.log("결제 승인 요청을 보냈습니다"),m(`/user/placetoorder/request/${n}`)):console.log("요청에 실패했습니다. 다시 시도해주세요")}catch(r){console.log(r)}},A=({target:{value:e}},r)=>{console.log(e),b(t=>({...t,[r]:e}))};console.log("금액 : ",a),console.log("사람 : ",i);const k=e=>{w(t=>{const o={...t,[e]:!t[e]};return t[e]?x(f=>f+Number(a[e])):x(f=>f-Number(a[e])),o});const r=parseInt(a[e]);p(t=>({...t,point:[...t.point,r]}))},C=()=>{m(`/user/placetoorder/member/${n}`)},D=()=>{p(e=>({...e,point:[],userId:[parseInt(h)]})),I(e=>[...e]),m(-1)};return console.log(c),s.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[s.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[s.jsx("div",{className:"flex w-[15%] justify-center",children:s.jsx(z,{className:"text-3xl",onClick:()=>D()})}),s.jsx("span",{className:"text-lg font-semibold",children:"금액 선택"}),s.jsx("div",{className:"w-[15%]",children:s.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),s.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[s.jsxs("div",{className:"flex w-full justify-center gap-2 pt-4 text-xl",children:[s.jsx("span",{children:"총 결제 금액 : "}),s.jsx("span",{className:`text-end px-2 ${Math.sign(parseInt(d))===-1?"text-red":"text-black"}`,children:d==null?void 0:d.toLocaleString("ko-KR")})]}),Array.isArray(c)&&(c==null?void 0:c.map(e=>{var r;return s.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[s.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[e.name,"(",e.uid,")"]}),s.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:y[e.userId]?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-end px-2",children:(r=a[e.userId])==null?void 0:r.toLocaleString("ko-KR")}),s.jsx("span",{children:"원"})]}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:t=>A(t,e.userId),value:a[e.userId]||""}),s.jsx("span",{children:"원"})]})}),s.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:s.jsx("span",{onClick:()=>k(e.userId),className:"bg-blue px-2 text-white font-medium rounded-md cursor-pointer",children:y[e.userId]?"수정":"확인"})})]},e.userId)})),s.jsx("div",{className:"flex w-full h-[5%] justify-center items-center",children:s.jsx(B,{onClick:C,className:"text-3xl"})}),s.jsx("div",{className:"flex w-full justify-center",children:s.jsx("span",{onClick:()=>v(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md",children:"승인 요청"})})]})]})};export{V as default};
