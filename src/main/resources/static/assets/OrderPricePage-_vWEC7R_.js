import{r,l as f,a9 as D,G as B,af as P,u as M,B as O,a6 as T,j as s,I as L,ah as $,g,h as E}from"./index-DJgBPc4Q.js";import"./lodash-CVdNur_4.js";const H=()=>{const[R,z]=r.useState({}),[n,b]=r.useState({}),[j,N]=r.useState({}),[c,i]=r.useState(0),[d,v]=f(D);f(B);const[l,A]=f(P),w=M(),u=sessionStorage.getItem("userId"),x=O(),{state:y}=T(),[p,m]=r.useState({orderId:0,userId:y.paymentMember.userId,point:[]});console.log(y.paymentMember),r.useEffect(()=>{const e={userId:u};(async()=>{try{const t=await g.get("/api/user/orderId",{params:e,headers:{Authorization:`Bearer ${x}`}});console.log(t.data.resultData);const o=t.data.resultData;m({...p,orderId:o}),v(o)}catch(t){console.log(t)}})()},[d]),r.useEffect(()=>{const e={orderId:d};(async()=>{try{const t=await g.get("/api/order",{params:e,headers:{Authorization:`Bearer ${x}`}});console.log(t.data.resultData);const o=t.data.resultData.totalPrice;i(o)}catch(t){console.log(t)}})()},[]);const k=async()=>{const e={orderId:d,userId:p.userId||u,point:p.point};console.log(e);try{const a=await g.post("/api/user/user-payment-member",e,{headers:{Authorization:`Bearer ${x}`}});console.log(a.data.resultData),a.data.resultData>=0?(console.log("결제 승인 요청을 보냈습니다"),w(`/user/placetoorder/request/${d}`)):console.log("요청에 실패했습니다. 다시 시도해주세요")}catch(a){console.log(a)}},C=({target:{value:e}},a)=>{console.log(e),b(t=>({...t,[a]:e}))},S=e=>{N(t=>{const o={...t,[e]:!t[e]};return t[e]?i(h=>h+Number(n[e])):i(h=>h-Number(n[e])),o});const a=parseInt(n[e]);m(t=>({...t,point:[...t.point,a]}))},I=()=>{E.fire({icon:"warning",title:"다시 시작하시겠습니까?",text:"확인을 누를 시, 인원 선택을 다시 해야합니다",showCancelButton:!0,confirmButtonText:"확인",cancelButtonText:"취소"}).then(e=>{e.isConfirmed&&(m(a=>({...a,point:[],userId:[parseInt(u)]})),A([]),w(-1))})};return console.log(l),s.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[s.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[s.jsx("div",{className:"flex w-[15%] justify-center",children:s.jsx(L,{className:"text-3xl",onClick:()=>I()})}),s.jsx("span",{className:"text-lg font-semibold",children:"금액 선택"}),s.jsx("div",{className:"w-[15%]",children:s.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),s.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[s.jsxs("div",{className:"flex w-full justify-center gap-2 pt-4 text-xl",children:[s.jsx("span",{children:"총 결제 금액 : "}),s.jsx("span",{className:`text-end px-2 ${Math.sign(parseInt(c))===-1?"text-red":"text-black"}`,children:c==null?void 0:c.toLocaleString("ko-KR")})]}),Array.isArray(l)&&(l==null?void 0:l.map(e=>{var a;return s.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[s.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[e.name,"(",e.uid,")"]}),s.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:j[e.userId]?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-end px-2",children:(a=n[e.userId])==null?void 0:a.toLocaleString("ko-KR")}),s.jsx("span",{children:"원"})]}):s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:t=>C(t,e.userId),value:n[e.userId]||""}),s.jsx("span",{children:"원"})]})}),s.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:s.jsx("span",{onClick:()=>S(e.userId),className:"bg-blue px-2 text-white font-medium rounded-md cursor-pointer",children:j[e.userId]?"수정":"확인"})})]},e.userId)})),s.jsx("div",{className:"flex w-full h-[5%] justify-center items-center",children:s.jsx($,{onClick:I,className:"text-3xl"})}),s.jsx("div",{className:"flex w-full justify-center",children:s.jsx("span",{onClick:()=>k(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md",children:"승인 요청"})})]})]})};export{H as default};
