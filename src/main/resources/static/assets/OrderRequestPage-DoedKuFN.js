import{r as d,R as m,c as A,z as k,v as S,u as D,g as C,j as e,b as i,S as B}from"./index-XkiSkCIq.js";import{I as O}from"./index-Cu020-X3.js";import{c as z}from"./index-CVEDjnF9.js";import"./iconBase-DXw1Gjh5.js";const F=()=>{const[o,x]=d.useState([]),[g,P]=d.useState({}),[p,h]=d.useState({});m(A);const[n,f]=m(k),[$,j]=m(S),u=sessionStorage.getItem("userId"),w=D(),l=C();d.useEffect(()=>{const s={userId:u};(async()=>{try{const t=await i.get("/api/user/orderId",{params:s,headers:{Authorization:`Bearer ${l}`}});console.log(t.data.resultData);const r=t.data.resultData;f(r)}catch(t){console.log(t)}})()},[]),d.useEffect(()=>{const s={orderId:n};(async()=>{try{const t=await i.get("/api/user/user-payment-member/userPaymentMember",{params:s,headers:{Authorization:`Bearer ${l}`}});console.log(t.data.resultData);const r=t.data.resultData;x([...r])}catch(t){console.log(t)}})()},[]);const y=async()=>{const s={orderId:n};try{const a=await i.get("/api/user/user-payment-member/userOrderApprovalAccess",{params:s,headers:{Authorization:`Bearer ${l}`}});console.log(a.data.resultData);const t=a.data.resultData;x([...t])}catch(a){console.log(a)}},b=async()=>{const s={orderId:parseInt(n)};try{const a=await i.post("/api/user/user-payment-member/insTicket",s,{headers:{Authorization:`Bearer ${l}`}});console.log(a.data.resultData);const t=a.data.resultData;window.sessionStorage.setItem("ticketId",t),j(t),B.fire({title:"결제 완료!",text:"식권이 생성되었습니다.",timer:2e3}),w(`/user/placetoorder/coupon/${t}`)}catch(a){console.log(a)}};console.log(n);const N=async s=>{console.log(s);const a={orderId:n,userId:s,approvalStatus:1};console.log(a);try{const t=await i.patch("/api/user/user-payment-member",a,{headers:{Authorization:`Bearer ${l}`}});console.log(t.data);const r=t.data.resultData}catch(t){console.log(t)}},v=s=>{console.log(s);const a=parseInt(g[s]);console.log("입력값",a,s),p?N(s):(x(t=>{const r=t.map(c=>c.userId===s?{...c,point:a}:c);return r.some(c=>c.userId===s)?r:[...r,{userId:s,point:a}]}),h(t=>({...t,[s]:!t[s]})))},I=s=>{h(!p),console.log(s)};return console.log(o),e.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[e.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[e.jsx("div",{className:"flex w-[15%] justify-center",children:e.jsx(O,{className:"text-3xl"})}),e.jsx("span",{className:"text-lg font-semibold",children:"결제 상태"}),e.jsx("div",{className:"w-[15%]",children:e.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[e.jsx("div",{className:"flex w-full items-center justify-center mt-6",children:e.jsxs("div",{className:"flex gap-2 px-5 py-2 bg-gray rounded-md",children:[e.jsx(z,{className:"text-2xl"}),e.jsx("span",{onClick:()=>y(),className:"text-lg font-medium cursor-pointer",children:"승인 상태 확인"})]})}),Array.isArray(o)&&o.map((s,a)=>e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsx("span",{className:"flex w-[30%] text-base text-nowrap",children:s.name}),e.jsx("div",{className:"flex w-[40%] gap-2 items-center justify-end",children:p[s.userId]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2 text-nowrap",children:s.point}),e.jsx("span",{children:"원"})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{children:s.approvalStatus===0?e.jsx("span",{className:"text-red font-semibold text-nowrap text-opacity-70",children:"대기중"}):s.approvalStatus===1?e.jsx("span",{className:"text-blue font-semibold text-nowrap",children:"승인"}):e.jsx("span",{className:"text-red font-semibold text-nowrap",children:"거절"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-end px-1 text-nowrap",children:s.point}),e.jsx("span",{children:"원"})]})]})})}),s.userId===parseInt(u)?e.jsxs("div",{className:"flex w-[20%] justify-center gap-2 text-nowrap items-center",children:[e.jsx("span",{onClick:()=>v(s.userId),className:"bg-blue px-2 text-white font-semibold rounded-md cursor-pointer",children:"승인"}),e.jsx("span",{onClick:()=>I(s.userId),className:"bg-red px-2 text-white font-semibold rounded-md cursor-pointer",children:p[s.userId]?"수정":"거절"})]}):e.jsxs("div",{className:"flex w-[20%] justify-center gap-2 text-nowrap items-center pointer-events-none",children:[e.jsx("span",{className:"bg-blue px-2 text-white font-semibold rounded-md"}),e.jsx("span",{className:"bg-red px-2 text-white font-semibold rounded-md"})]})]},a)),e.jsx("div",{className:"flex w-full justify-center gap-10",children:(o==null?void 0:o.userId)!==parseInt(u)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{onClick:()=>b(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md cursor-pointer",children:"결제 요청"}),e.jsx("span",{className:"bg-red text-white text-lg px-2 py-1 rounded-md cursor-pointer",children:"결제 취소"})]})})]})]})};export{F as default};
