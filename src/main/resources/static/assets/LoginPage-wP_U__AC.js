import{u as T,R as d,l as F,i as E,c as U,r as u,a as A,j as s,b as x,s as f,S as B}from"./index-XkiSkCIq.js";import{u as H}from"./index.esm-j2erOJPr.js";import{a as _}from"./index-Cu020-X3.js";import{r as N,U as m,S as r}from"./roleAtom-ClRng8Ap.js";import{L as O,H as V,C as M,T as P,b as Y,R as q,F as z,I as j,S,a as G,c as i}from"./loginStyle-DMumf38V.js";import"./iconBase-DXw1Gjh5.js";function ts(){const n=T(),[J,p]=d(F),[K,w]=d(E),[Q,y]=d(U),[t,g]=u.useState({id:"",pw:""}),[h,I]=u.useState(!1),D=sessionStorage.getItem("userId"),b=sessionStorage.getItem("restaurantId"),{handleSubmit:v}=H(),a=A(N),C=()=>{a===m?n("/user"):a===r&&n("/store")},L=async()=>{try{if(a===m){const e=(await x.post("/api/user/sign-in",t)).data.resultData;y({companyId:e.companyId,companyName:e.companyName,email:e.email,name:e.name,phone:e.phone,pic:e.pic,point:e.point,roleId:e.roleId,uid:e.uid,userId:e.userId}),console.log(e);const l=e.userId||D,c=e.accessToken;window.sessionStorage.setItem("userId",l),f(c),p(!0)}else if(a===r){const o=await x.post("/api/admin/sign-in",t);console.log(o.data.resultData);const e=o.data.resultData,l=e.restaurantId||b,c=e.adminId,R=e.accessToken;window.sessionStorage.setItem("adminId",c),window.sessionStorage.setItem("restaurantId",l),f(R),w(!0)}p(!0),C()}catch(o){B.fire({title:"아이디와 비밀번호가 일치하지 않습니다.",icon:"error",confirmButtonText:"확인",showConfirmButton:!0,allowOutsideClick:!1}),console.log(o)}},k=()=>{L()};return u.useEffect(()=>{t.id&&t.pw?I(!0):I(!1)},[t]),s.jsxs(O,{children:[s.jsx(V,{children:s.jsx(M,{children:s.jsx(_,{style:{width:"100%",height:"100%",cursor:"pointer"},onClick:()=>n("/")})})}),s.jsxs(P,{children:[s.jsx(Y,{src:"/logo.png",alt:"로고"}),s.jsx(q,{children:a===m?"사용자":a===r?"사장님":""})]}),s.jsx(z,{children:s.jsxs("form",{onSubmit:v(k),children:[s.jsx(j,{children:s.jsx(S,{type:"text",placeholder:"아이디",value:t.id,onChange:o=>g({...t,id:o.target.value})})}),s.jsx(j,{children:s.jsx(S,{type:"password",value:t.pw,placeholder:"비밀번호 (8-16자)",onChange:o=>g({...t,pw:o.target.value})})}),s.jsx("div",{style:{marginLeft:20,marginRight:20},children:s.jsx(G,{type:"submit",style:{backgroundColor:h?"#6F4CDB":"#ddd"},disabled:!h,children:"로그인"})})]})}),s.jsx(i,{onClick:()=>n("/auth/findid"),children:"아이디 찾기"}),s.jsx(i,{style:{color:"#bababa"},children:"I"}),s.jsx(i,{onClick:()=>n("/auth/findpw"),children:"비밀번호 찾기"}),a===r&&s.jsxs(s.Fragment,{children:[s.jsx(i,{style:{color:"#bababa"},children:"I"}),s.jsx(i,{style:{marginRight:25},onClick:()=>n("/auth/policy"),children:"회원가입"})]})]})}export{ts as default};
