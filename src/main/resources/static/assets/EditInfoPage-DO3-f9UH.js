import{u as B,l as x,D as F,z as L,r,j as e,I as M,s as G,y as g,g as j,h}from"./index-BEM99ApS.js";import{b as N}from"./index-EXaYp185.js";import{a as z}from"./index-z-0vrsf_.js";import{i as D,M as H}from"./MenuBar-kjpK3CF1.js";import{N as O}from"./NotificationIcon-DFgTuZdO.js";import{l as W}from"./lodash-CVdNur_4.js";import"./index-TzKRpCpo.js";import"./index-C2QPySdM.js";function se(){const i=B(),[s,u]=x(F),[T,b]=x(D);x(L);const[c,v]=r.useState(null),[w,y]=r.useState(""),[d,I]=r.useState(null),[k,f]=r.useState(""),[V,_]=r.useState(null),p=window.sessionStorage.getItem("userId");r.useEffect(()=>{if(!d){f("");return}const t=URL.createObjectURL(d);return f(t),()=>URL.revokeObjectURL(t)},[d]),r.useEffect(()=>{b(!1),(async()=>{try{if(p){const n={userId:p},o=g(),a=await j.get("/api/user",{params:n,headers:{Authorization:`Bearer ${o}`}}),l=a.data.resultData,E=l.phone.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),A=l.point.toLocaleString("ko-KR");console.log(l),console.log(a),u({...l,phone:E,point:A})}}catch(n){console.log(n)}})()},[]);const C=async t=>{t.preventDefault();const n={userId:p};try{const o=g(),a={nickName:w||s.nickName,phone:c||s.phone},l=await j.patch("/api/user",a,{params:n,headers:{Authorization:`Bearer ${o}`}});h.fire({icon:"success",title:"수정이 완료되었습니다.",showConfirmButton:!1,timer:1500}),u({...s,...a}),i("/user/userInfo")}catch(o){console.error(o),h.fire("수정 실패","정보 수정에 실패하였습니다.","error")}},$=()=>{h.fire({icon:"warning",title:"수정이 취소되었습니다.",showConfirmButton:!1,timer:1500}).then(()=>{i("/user/userInfo")})},m=r.useCallback(W.debounce(t=>{console.log("delayInput : ",t),y(t)},500),[]),S=t=>{m(t.target.value)};r.useEffect(()=>()=>{m.cancel()},[m]);const U=t=>{const a=t.target.value.replace(/[^0-9]/g,"").slice(0,11).replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/,"$1-$2-$3").replace(/(-{1,2})$/,"");v(a)},P=t=>{console.log(t.target.files[0]);const n=t.target.files[0];I(n)},R=k||(s==null?void 0:s.pic)||"/profile.jpeg";return e.jsxs("div",{className:"h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide bg-white",children:[e.jsx(O,{}),e.jsxs("div",{className:"absolute top-0 left-0 w-full flex justify-between items-center px-3 py-5 border-b-2 border-gray border-opacity-70 bg-white",children:[e.jsx(M,{className:"text-3xl cursor-pointer",onClick:()=>i("/user")}),e.jsx("span",{className:"text-xl font-semibold pointer-events-none",children:"회원 정보 수정"}),e.jsx("span",{children:" "})]}),e.jsxs("div",{className:"flex flex-col h-dvh justify-around mt-24 gap-10",children:[e.jsxs("div",{className:"w-full h-[30%] flex flex-col items-center gap-4",children:[s.pic!==null?e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"profile",children:e.jsxs("div",{className:"relative cursor-pointer",children:[e.jsx("img",{src:s.pic,alt:"프로필 이미지",className:"w-32 h-32 rounded-full object-cover"}),e.jsxs("div",{className:"absolute bottom-0 -right-1 text-xl bg-darkGray p-2 rounded-full border-4 border-white",children:[e.jsx("input",{type:"file",className:"hidden"}),e.jsx(N,{className:"text-white"})]})]})}),e.jsx("input",{id:"profile",type:"file",className:"absolute left-[5000px] hidden"})]}):e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"profile",children:e.jsxs("div",{className:"relative cursor-pointer",children:[e.jsx("img",{src:R,alt:"프로필 이미지",className:"w-32 h-32 rounded-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 -right-1 text-xl bg-darkGray p-2 rounded-full border-4 border-white",children:e.jsx(N,{className:"text-white"})})]})}),e.jsx("input",{id:"profile",type:"file",className:"absolute left-[5000px] hidden",onChange:P})]}),e.jsxs("div",{className:"flex items-center pointer-events-none",children:[e.jsx("span",{className:"pr-3",children:"사용가능 포인트"}),e.jsx("span",{className:"font-bold text-2xl",children:s.point})]}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1 border-2 border-gray rounded-xl pointer-events-none",children:[e.jsx(z,{className:"text-xl"}),s.email]}),e.jsxs("div",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("span",{className:"text-lg font-semibold",children:"내가 작성한 리뷰"}),e.jsx(G,{className:"text-xl font-semibold"})]})]}),e.jsx("div",{className:"h-[40%] flex justify-center items-center",children:e.jsxs("div",{className:"flex w-1/2 gap-5 items-center",children:[e.jsxs("div",{className:"flex flex-col w-[20%] gap-6 font-thin text-lg h-full text-darkGray text-nowrap",children:[e.jsx("span",{children:"닉네임"}),e.jsx("span",{children:"이름"}),e.jsx("span",{children:"아이디"}),e.jsx("span",{children:"소속"}),e.jsx("span",{children:"휴대폰"})]}),e.jsxs("div",{className:"flex flex-col w-[80%] gap-6 font-medium text-lg h-full text-nowrap",children:[e.jsx("div",{className:"flex items-center gap-2 cursor-pointer",children:s.nickName?e.jsx("span",{children:s.nickName}):e.jsx("input",{type:"text",placeholder:s!=null&&s.nickName?s.nickName:"닉네임을 설정해주세요",onChange:S,className:"flex w-48 border rounded-md px-2"})}),e.jsx("span",{className:"pointer-events-none",children:s.name}),e.jsx("span",{className:"pointer-events-none",children:s.uid}),e.jsx("span",{className:"pointer-events-none",children:s.companyName}),e.jsx("div",{className:"flex items-center gap-2 cursor-pointer",children:e.jsx("input",{type:"tel",value:c||s.phone,onChange:U,className:"flex w-48 border rounded-md px-2"})})]})]})}),e.jsxs("div",{className:"flex h-[20%] justify-center gap-5 mb-32",children:[e.jsx("div",{onClick:C,children:e.jsx("span",{className:"flex px-3 py-1 bg-primary rounded-lg text-white font-semibold text-center cursor-pointer",children:"수정 완료"})}),e.jsx("div",{onClick:$,children:e.jsx("span",{className:"flex px-3 py-1 bg-darkGray rounded-lg text-white font-semibold text-center cursor-pointer",children:"취소하기"})})]})]}),e.jsx(H,{})]})}export{se as default};
