import{u as E,m as x,H as F,E as A,r as a,j as e,I as B,t as M,g as j,c as N,d as u}from"./index-ji0Yrnpj.js";import{b}from"./index-DPSCt2xo.js";import{a as O}from"./index-So2cuFMT.js";import{l as D}from"./lodash-CVdNur_4.js";import{i as G,M as H}from"./MenuBar-DGtHK_nx.js";import{N as V}from"./NotificationIcon-CfiYXa3K.js";import"./index-DaTKmmlO.js";import"./index-CivAqP-9.js";function se(){const c=E(),[s,h]=x(F),[W,v]=x(G);x(A);const[d,w]=a.useState(null),[y,I]=a.useState(""),[i,z]=a.useState(null),[k,m]=a.useState(""),[T,_]=a.useState(null),f=window.sessionStorage.getItem("userId");a.useEffect(()=>{if(!i){m("");return}const t=URL.createObjectURL(i);return m(t),()=>URL.revokeObjectURL(t)},[i]),a.useEffect(()=>{v(!1),(async()=>{try{if(f){const r={userId:f},n=j(),l=(await N.get("/api/user",{params:r,headers:{Authorization:`Bearer ${n}`}})).data.resultData,S=l.phone.replace(/[^0-9]/g,"").replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3").replace(/(-{1,2})$/g,""),L=l.point.toLocaleString("ko-KR");console.log(l),h({...l,phone:S,point:L})}}catch(r){console.log(r)}})()},[]);const C=async t=>{t.preventDefault();try{const r=j(),n={nickName:y||s.nickName,phone:d||s.phone},o=new FormData;o.append("userPic",i);const l=await N.patch("/api/user/v3/userInfo",o,{params:n,headers:{Authorization:`Bearer ${r}`}});u.fire({icon:"success",title:"수정이 완료되었습니다.",showConfirmButton:!1,timer:1500}),h({...s,...payload}),c("/user/userInfo")}catch(r){console.error(r),u.fire("수정 실패","정보 수정에 실패하였습니다.","error")}},U=()=>{u.fire({icon:"warning",title:"수정이 취소되었습니다.",showConfirmButton:!1,timer:1500}).then(()=>{c("/user/userInfo")})},p=a.useCallback(D.debounce(t=>{console.log("delayInput : ",t),I(t)},500),[]),g=t=>{p(t.target.value)};a.useEffect(()=>()=>{p.cancel()},[p]);const R=t=>{const o=t.target.value.replace(/[^0-9]/g,"").slice(0,11).replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/,"$1-$2-$3").replace(/(-{1,2})$/,"");w(o)},$=t=>{const r=t.target.files[0];if(!r)return;setImageFile(r);const n=URL.createObjectURL(r);return m(n),()=>URL.revokeObjectURL(n)},P=k||(s==null?void 0:s.usePic)||"/profile.jpeg";return e.jsxs("div",{className:"h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide bg-white",children:[e.jsx(V,{}),e.jsxs("div",{className:"absolute top-0 left-0 w-full flex justify-between items-center px-3 py-5 border-b-2 border-gray border-opacity-70 bg-white",children:[e.jsx(B,{className:"text-3xl cursor-pointer",onClick:()=>c("/user")}),e.jsx("span",{className:"text-xl font-semibold pointer-events-none",children:"회원 정보 수정"}),e.jsx("span",{children:" "})]}),e.jsxs("div",{className:"flex flex-col h-dvh justify-around mt-24 gap-10",children:[e.jsxs("div",{className:"w-full h-[30%] flex flex-col items-center gap-4",children:[s.usePic!==null?e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"profile",children:e.jsxs("div",{className:"relative cursor-pointer",children:[e.jsx("img",{src:s.usePic,alt:"프로필 이미지",className:"w-32 h-32 rounded-full object-cover"}),e.jsxs("div",{className:"absolute bottom-0 -right-1 text-xl bg-darkGray p-2 rounded-full border-4 border-white",children:[e.jsx("input",{type:"file",className:"hidden"}),e.jsx(b,{className:"text-white"})]})]})}),e.jsx("input",{id:"profile",type:"file",className:"absolute left-[5000px] hidden"})]}):e.jsxs(e.Fragment,{children:[e.jsx("label",{htmlFor:"profile",children:e.jsxs("div",{className:"relative cursor-pointer",children:[e.jsx("img",{src:P,alt:"프로필 이미지",className:"w-32 h-32 rounded-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 -right-1 text-xl bg-darkGray p-2 rounded-full border-4 border-white",children:e.jsx(b,{className:"text-white"})})]})}),e.jsx("input",{id:"profile",type:"file",className:"absolute left-[5000px] hidden",onChange:$})]}),e.jsxs("div",{className:"flex items-center pointer-events-none",children:[e.jsx("span",{className:"pr-3",children:"사용가능 포인트"}),e.jsx("span",{className:"font-bold text-2xl",children:s.point})]}),e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1 border-2 border-gray rounded-xl pointer-events-none",children:[e.jsx(O,{className:"text-xl"}),s.email]}),e.jsxs("div",{className:"flex items-center gap-1 cursor-pointer",children:[e.jsx("span",{className:"text-lg font-semibold",children:"내가 작성한 리뷰"}),e.jsx(M,{className:"text-xl font-semibold"})]})]}),e.jsx("div",{className:"h-[40%] flex justify-center items-center",children:e.jsxs("div",{className:"flex w-1/2 gap-5 items-center",children:[e.jsxs("div",{className:"flex flex-col w-[20%] gap-6 font-thin text-lg h-full text-darkGray text-nowrap",children:[e.jsx("span",{children:"닉네임"}),e.jsx("span",{children:"이름"}),e.jsx("span",{children:"아이디"}),e.jsx("span",{children:"소속"}),e.jsx("span",{children:"휴대폰"})]}),e.jsxs("div",{className:"flex flex-col w-[80%] gap-6 font-medium text-lg h-full text-nowrap",children:[e.jsx("div",{className:"flex items-center gap-2 cursor-pointer",children:s.nickName?e.jsx("input",{type:"text",onChange:g,className:"flex w-48 border rounded-md px-2",defaultValue:s.nickName}):e.jsx("input",{type:"text",placeholder:s!=null&&s.nickName?s.nickName:"닉네임을 설정해주세요",onChange:g,className:"flex w-48 border rounded-md px-2"})}),e.jsx("span",{className:"pointer-events-none",children:s.name}),e.jsx("span",{className:"pointer-events-none",children:s.uid}),e.jsx("span",{className:"pointer-events-none",children:s.companyName}),e.jsx("div",{className:"flex items-center gap-2 cursor-pointer",children:e.jsx("input",{type:"tel",value:d||s.phone,onChange:R,className:"flex w-48 border rounded-md px-2"})})]})]})}),e.jsxs("div",{className:"flex h-[20%] justify-center gap-5 mb-32",children:[e.jsx("div",{onClick:C,children:e.jsx("span",{className:"flex px-3 py-1 bg-primary rounded-lg text-white font-semibold text-center cursor-pointer",children:"수정 완료"})}),e.jsx("div",{onClick:U,children:e.jsx("span",{className:"flex px-3 py-1 bg-darkGray rounded-lg text-white font-semibold text-center cursor-pointer",children:"취소하기"})})]})]}),e.jsx(H,{})]})}export{se as default};
